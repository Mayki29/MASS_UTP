<!-- pages/productos.html -->
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Gestión MASS - Productos</title>

    <!-- 1. Estilos COMUNES a toda la aplicación -->
    <link rel="stylesheet" href="../styles/common.css">
    <!-- 2. Estilos ESPECÍFICOS de esta página -->
    <link rel="stylesheet" href="../styles/productos.css">
    <link rel="icon" type="image/png" href="../assets/favicon.png">
    
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body>
    <script>
        // Script para aplicar el tema guardado inmediatamente
        (function() {
            // 1. Obtener el objeto completo de configuración
            const settingsString = localStorage.getItem('appSettings');
            if (settingsString) {
                // 2. Convertirlo a un objeto JavaScript
                const settings = JSON.parse(settingsString);
                // 3. Si existe una preferencia de tema y es 'oscuro', aplicar la clase
                if (settings && settings.temaVisual === 'oscuro') {
                    document.body.classList.add('dark-theme');
                }
            }
        })();
    </script>
    <header>
        <div class="logo">
            <img src="../assets/store-icon-flat-design-by-Vexels.svg" alt="Logo MASS" width="30" height="30">
            <span>MASS</span>
        </div>
        <nav>
            <ul>
                <li><a href="main.html">Inicio</a></li>
                <li><a href="productos.html">Productos</a></li>
                <li><a href="inventario.html">Inventario</a></li>
                <li><a href="ventas.html">Ventas</a></li>
                <li><a href="reportes.html">Reportes</a></li>
                <li><a href="historial_ventas.html">Historial</a></li>
            </ul>
        </nav>
        <div class="user-dropdown">
            <div class="user-info">
                <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px"><path d="M0 0h24v24H0z" fill="none"/><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"/></svg>
                <span id="userInfo">Admin</span>
            </div>
            <div class="user-dropdown-content">
                <a href="perfil.html">Ver Perfil</a>
                <a href="configuracion.html">Configuración</a>
                <a href="ayuda.html">Ayuda</a>
                <hr style="margin: 0;">
                <a href="login.html" id="logoutButton">Cerrar Sesión</a>
            </div>
        </div>
    </header>

    <main>
        <h2>Gestión de Productos</h2>
        <button id="abrirModalBtn">✚ Nuevo Producto</button>
        
        <!-- Aquí se renderizarán los productos con JavaScript -->
        <div class="product-list"></div>
    </main>

    <!-- Modal para Nuevo Producto/Editar -->
    <div id="productModal" class="modal">
        <div class="modal-content">
            <span class="close-btn">×</span>
            <h2 id="modalTitulo">Nuevo Producto</h2>
            <form id="productForm">
                <!-- Input oculto para guardar el ID del producto a editar -->
                <input type="hidden" id="productId">

                <label for="nombre">Nombre del Producto</label>
                <input type="text" id="nombre" name="nombre" required>
                
                <label for="precio">Precio (S/)</label>
                <input type="number" step="0.01" id="precio" name="precio" required>
                
                <label for="stock">Stock Inicial</label>
                <input type="number" id="stock" name="stock" required>
                
                
                <label for="stockMinimo">Stock Minimo</label>
                <input type="number" id="stockMinimo" name="stockMinimo" required>

                <label for="fecha">Fecha de Caducidad</label>
                <input type="date" id="fecha" name="fecha">

                <label for="categoria">Categoría</label>
                <select id="categoria" name="categoria">
                    <option value="">Seleccione una categoría</option>
                </select>

                <label for="imagen">Imagen</label>
                <input type="file" id="imagen" name="imagen" accept="image/*" required>

                
                <label for="categoria">Categoría</label>
                <select id="categoria" name="categoria">
                    <option value="">Seleccione una categoría</option>
                    <option value="abarrotes">Abarrotes</option>
                    <option value="limpieza">Limpieza</option>
                    <option value="bebidas">Bebidas</option>
                </select>
                
                <div class="form-actions">
                    <button type="button" id="cancelarBtn">Cancelar</button>
                    <button type="submit" id="guardarBtn">Guardar</button>
                </div>
            </form>
        </div>
    </div>

    <footer>
        © 2025 Mass - Todos los derechos reservados
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
    <!-- 1. Scripts COMUNES a toda la aplicación -->
    <script src="../scripts/shared.js"></script>
    <!-- 2. Scripts ESPECÍFICOS de esta página -->
    <script src="../scripts/productos.js"></script>
</body>
</html>